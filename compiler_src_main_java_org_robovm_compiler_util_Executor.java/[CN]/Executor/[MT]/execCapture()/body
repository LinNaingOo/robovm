{
  ExecuteStreamHandler oldStreamHandler=streamHandler;
  try {
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    streamHandler(new PumpStreamHandler(baos));
    CommandLine commandLine=generateCommandLine();
    logCommandLine(commandLine);
    DefaultExecutor executor=initExecutor(new DefaultExecutor());
    executor.execute(commandLine,generateEnv());
    return new String(baos.toByteArray()).trim();
  }
  finally {
    streamHandler=oldStreamHandler;
  }
}
