{
  if (outbuf == null || offset < 0 || len < 0 || offset + len > outbuf.length) {
    throw new IllegalArgumentException(Messages.getString("security.05"));
  }
  if (state != SIGN) {
    throw new SignatureException(Messages.getString("security.27"));
  }
  return engineSign(outbuf,offset,len);
}
