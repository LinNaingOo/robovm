{
  final int pkeyType=NativeCrypto.EVP_PKEY_type(pkey.getPkeyContext());
switch (engineType) {
case RSA:
    if (pkeyType != NativeCrypto.EVP_PKEY_RSA) {
      throw new InvalidKeyException("Signature not initialized as RSA");
    }
  break;
case DSA:
if (pkeyType != NativeCrypto.EVP_PKEY_DSA) {
  throw new InvalidKeyException("Signature not initialized as DSA");
}
break;
case EC:
if (pkeyType != NativeCrypto.EVP_PKEY_EC) {
throw new InvalidKeyException("Signature not initialized as EC");
}
break;
default :
throw new InvalidKeyException("Need DSA or RSA or EC private key");
}
}
