{
  if (localOrRef instanceof StaticFieldRef) {
    return false;
  }
  if (dfa.printDebug())   G.v().out.println("      CLOA testing if " + localOrRef + " is local in "+ sm);
  SmartMethodLocalObjectsAnalysis smloa=getMethodLocalObjectsAnalysis(sm,includePrimitiveDataFlowIfAvailable);
  if (localOrRef instanceof InstanceFieldRef) {
    InstanceFieldRef ifr=(InstanceFieldRef)localOrRef;
    if (ifr.getBase().equivTo(smloa.getThisLocal()))     return isFieldLocal(ifr.getFieldRef().resolve());
 else {
      if (isObjectLocal(ifr.getBase(),sm,includePrimitiveDataFlowIfAvailable)) {
        boolean retval=loa.isFieldLocalToParent(ifr.getFieldRef().resolve());
        if (dfa.printDebug())         G.v().out.println("      " + (retval ? "local" : "shared"));
        return retval;
      }
 else {
        if (dfa.printDebug())         G.v().out.println("      shared");
        return false;
      }
    }
  }
  CallLocalityContext context=getContextFor(sm);
  boolean retval=smloa.isObjectLocal(localOrRef,context);
  if (dfa.printDebug())   G.v().out.println("      " + (retval ? "local" : "shared"));
  return retval;
}
