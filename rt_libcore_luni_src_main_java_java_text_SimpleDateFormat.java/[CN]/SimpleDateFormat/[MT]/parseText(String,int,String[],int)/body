{
  int bestIndex=-1;
  int bestLength=-1;
  for (int i=0; i < options.length; ++i) {
    String option=options[i];
    int optionLength=option.length();
    if (optionLength == 0) {
      continue;
    }
    if (string.regionMatches(true,offset,option,0,optionLength)) {
      if (bestIndex == -1 || optionLength > bestLength) {
        bestIndex=i;
        bestLength=optionLength;
      }
    }
 else     if (option.charAt(optionLength - 1) == '.') {
      if (string.regionMatches(true,offset,option,0,optionLength - 1)) {
        if (bestIndex == -1 || optionLength - 1 > bestLength) {
          bestIndex=i;
          bestLength=optionLength - 1;
        }
      }
    }
  }
  if (bestIndex != -1) {
    calendar.set(field,bestIndex);
    return offset + bestLength;
  }
  return -offset - 1;
}
