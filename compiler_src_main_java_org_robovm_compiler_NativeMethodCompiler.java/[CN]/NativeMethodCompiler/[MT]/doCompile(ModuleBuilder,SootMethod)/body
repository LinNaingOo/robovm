{
  Function fn=FunctionBuilder.method(method);
  moduleBuilder.addFunction(fn);
  Value env=fn.getParameterRef(0);
  ArrayList<Value> args=new ArrayList<Value>(Arrays.asList(fn.getParameterRefs()));
  if (method.isStatic()) {
    FunctionRef ldcFn=FunctionBuilder.ldcInternal(sootMethod.getDeclaringClass()).ref();
    Value clazz=call(fn,ldcFn,env);
    args.add(1,clazz);
  }
  pushNativeFrame(fn);
  FunctionRef targetFn=createNative(moduleBuilder,method);
  Value result=call(fn,targetFn,args);
  popNativeFrame(fn);
  call(fn,BC_THROW_IF_EXCEPTION_OCCURRED,env);
  fn.add(new Ret(result));
  return fn;
}
