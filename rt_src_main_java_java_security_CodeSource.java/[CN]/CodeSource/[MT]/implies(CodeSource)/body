{
  if (cs == null) {
    return false;
  }
  Certificate[] thizCerts=getCertificatesNoClone();
  if (thizCerts != null) {
    Certificate[] thatCerts=cs.getCertificatesNoClone();
    if (thatCerts == null || !PolicyUtils.matchSubset(thizCerts,thatCerts)) {
      return false;
    }
  }
  if (this.location != null) {
    if (cs.location == null) {
      return false;
    }
    if (this.location.equals(cs.location)) {
      return true;
    }
    if (!this.location.getProtocol().equals(cs.location.getProtocol())) {
      return false;
    }
    String thisHost=this.location.getHost();
    if (thisHost != null) {
      String thatHost=cs.location.getHost();
      if (thatHost == null) {
        return false;
      }
      if (!((thisHost.length() == 0 || "localhost".equals(thisHost)) && (thatHost.length() == 0 || "localhost".equals(thatHost))) && !thisHost.equals(thatHost)) {
        if (this.sp == null) {
          this.sp=new SocketPermission(thisHost,"resolve");
        }
        if (cs.sp == null) {
          cs.sp=new SocketPermission(thatHost,"resolve");
        }
        if (!this.sp.implies(cs.sp)) {
          return false;
        }
      }
    }
    if (this.location.getPort() != -1) {
      if (this.location.getPort() != cs.location.getPort()) {
        return false;
      }
    }
    String thisFile=this.location.getFile();
    String thatFile=cs.location.getFile();
    if (thisFile.endsWith("/-")) {
      if (!thatFile.startsWith(thisFile.substring(0,thisFile.length() - 2))) {
        return false;
      }
    }
 else     if (thisFile.endsWith("/*")) {
      if (!thatFile.startsWith(thisFile.substring(0,thisFile.length() - 2))) {
        return false;
      }
      if (thatFile.indexOf("/",thisFile.length() - 1) != -1) {
        return false;
      }
    }
 else {
      if (!thisFile.equals(thatFile)) {
        if (!thisFile.endsWith("/")) {
          if (!thatFile.equals(thisFile + "/")) {
            return false;
          }
        }
 else {
          return false;
        }
      }
    }
    if (this.location.getRef() != null) {
      if (!this.location.getRef().equals(cs.location.getRef())) {
        return false;
      }
    }
  }
  return true;
}
