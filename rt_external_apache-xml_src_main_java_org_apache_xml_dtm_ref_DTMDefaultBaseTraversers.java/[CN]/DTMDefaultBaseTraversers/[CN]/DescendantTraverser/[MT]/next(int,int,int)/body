{
  int subtreeRootIdent=getSubtreeRoot(context);
  current=makeNodeIdentity(current) + 1;
  if (isIndexed(expandedTypeID)) {
    return makeNodeHandle(getNextIndexed(subtreeRootIdent,current,expandedTypeID));
  }
  for (; ; current++) {
    int exptype=_exptype(current);
    if (!isDescendant(subtreeRootIdent,current))     return NULL;
    if (exptype != expandedTypeID)     continue;
    return makeNodeHandle(current);
  }
}
