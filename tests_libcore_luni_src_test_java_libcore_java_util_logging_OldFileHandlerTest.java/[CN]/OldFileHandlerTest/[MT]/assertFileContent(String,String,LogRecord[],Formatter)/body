{
  handler.close();
  String msg="";
  if (null != formatter) {
    StringBuffer sb=new StringBuffer();
    sb.append(formatter.getHead(handler));
    for (int i=0; i < lr.length; i++) {
      if (null == lr[i] && i < lr.length - 1) {
        sb.append(formatter.getTail(handler));
        sb.append(formatter.getHead(handler));
      }
 else {
        sb.append(formatter.format(lr[i]));
      }
    }
    sb.append(formatter.getTail(handler));
    msg=sb.toString();
  }
  char[] chars=new char[msg.length()];
  Reader reader=null;
  try {
    reader=new BufferedReader(new FileReader(homepath + SEP + filename));
    reader.read(chars);
    assertEquals(msg,new String(chars));
    assertEquals(-1,reader.read());
  }
  finally {
    try {
      if (reader != null) {
        reader.close();
      }
    }
 catch (    Exception e) {
    }
    reset(homepath,filename);
  }
}
