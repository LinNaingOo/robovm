{
  int enterCounter=matchResult.getEnterCounter(setCounter);
  if (!innerSet.hasConsumed(matchResult))   return next.matches(stringIndex,testString,matchResult);
  if (enterCounter >= quantifier.max()) {
    matchResult.setEnterCounter(setCounter,0);
    return next.matches(stringIndex,testString,matchResult);
  }
  int nextIndex;
  if (enterCounter >= quantifier.min()) {
    nextIndex=next.matches(stringIndex,testString,matchResult);
    if (nextIndex < 0) {
      matchResult.setEnterCounter(setCounter,++enterCounter);
      nextIndex=innerSet.matches(stringIndex,testString,matchResult);
    }
 else {
      matchResult.setEnterCounter(setCounter,0);
      return nextIndex;
    }
  }
 else {
    matchResult.setEnterCounter(setCounter,++enterCounter);
    nextIndex=innerSet.matches(stringIndex,testString,matchResult);
  }
  return nextIndex;
}
