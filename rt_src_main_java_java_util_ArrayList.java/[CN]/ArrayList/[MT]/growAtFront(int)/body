{
  if (array.length - size >= required) {
    int newFirst=array.length - size;
    if (size != 0) {
      System.arraycopy(array,firstIndex,array,newFirst,size);
      int lastIndex=firstIndex + size;
      int length=lastIndex > newFirst ? newFirst : lastIndex;
      Arrays.fill(array,firstIndex,length,null);
    }
    firstIndex=newFirst;
  }
 else {
    int increment=size / 2;
    if (required > increment) {
      increment=required;
    }
    if (increment < 12) {
      increment=12;
    }
    E[] newArray=newElementArray(size + increment);
    if (size != 0) {
      System.arraycopy(array,firstIndex,newArray,increment,size);
    }
    firstIndex=newArray.length - size;
    array=newArray;
  }
}
