{
  keyType=name;
  try {
    CertificateFactory cf=CertificateFactory.getInstance("X.509");
    KeyFactory kf=KeyFactory.getInstance("RSA");
    keyTest=KeyStore.getInstance(KeyStore.getDefaultType());
    keyTest.load(null,"1234".toCharArray());
    if (keyType.equals(CLIENT)) {
      keys=new PrivateKey[3];
      keys[0]=kf.generatePrivate(new PKCS8EncodedKeySpec(keyBytes));
      keys[1]=kf.generatePrivate(new PKCS8EncodedKeySpec(key2Bytes));
      keys[2]=kf.generatePrivate(new PKCS8EncodedKeySpec(key3Bytes));
      cert=new X509Certificate[3];
      cert[0]=(X509Certificate)cf.generateCertificate(certArray);
      cert[1]=(X509Certificate)cf.generateCertificate(certArray2);
      cert[2]=(X509Certificate)cf.generateCertificate(certArray3);
      keyTest.setKeyEntry("clientKey_01",keys[0],PASSWORD,new X509Certificate[]{cert[0]});
      keyTest.setKeyEntry("clientKey_02",keys[1],PASSWORD,new X509Certificate[]{cert[0],cert[1]});
      keyTest.setKeyEntry("clientKey_03",keys[2],PASSWORD,new X509Certificate[]{cert[0],cert[2]});
      keyTest.setCertificateEntry("clientAlias_01",cert[0]);
      keyTest.setCertificateEntry("clientAlias_02",cert[0]);
      keyTest.setCertificateEntry("clientAlias_03",cert[1]);
    }
 else     if (keyType.equals(SERVER)) {
      keys=new PrivateKey[1];
      keys[0]=kf.generatePrivate(new PKCS8EncodedKeySpec(keyBytes));
      cert=new X509Certificate[1];
      cert[0]=(X509Certificate)cf.generateCertificate(certArray3);
      keyTest.setKeyEntry("serverKey_00",keys[0],PASSWORD,new X509Certificate[]{cert[0]});
      keyTest.setCertificateEntry("serverAlias_00",cert[0]);
    }
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    throw new IllegalArgumentException(ex.getMessage());
  }
  try {
    factory.init(keyTest,"1234".toCharArray());
  }
 catch (  Exception e) {
    fail("Could't init the KeyManagerFactory");
  }
  manager=(X509KeyManager)factory.getKeyManagers()[0];
}
