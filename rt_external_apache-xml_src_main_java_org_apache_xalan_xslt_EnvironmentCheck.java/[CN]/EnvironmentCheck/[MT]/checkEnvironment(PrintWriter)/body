{
  if (null != pw)   outWriter=pw;
  Hashtable hash=getEnvironmentHash();
  boolean environmentHasErrors=writeEnvironmentReport(hash);
  if (environmentHasErrors) {
    logMsg("# WARNING: Potential problems found in your environment!");
    logMsg("#    Check any 'ERROR' items above against the Xalan FAQs");
    logMsg("#    to correct potential problems with your classes/jars");
    logMsg("#    http://xml.apache.org/xalan-j/faq.html");
    if (null != outWriter)     outWriter.flush();
    return false;
  }
 else {
    logMsg("# YAHOO! Your environment seems to be OK.");
    if (null != outWriter)     outWriter.flush();
    return true;
  }
}
