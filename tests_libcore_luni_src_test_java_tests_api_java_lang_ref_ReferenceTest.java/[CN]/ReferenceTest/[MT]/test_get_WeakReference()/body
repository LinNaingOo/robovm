{
  ReferenceQueue<Object> queue=new ReferenceQueue<Object>();
  r=newWeakReference(queue);
  System.gc();
  System.runFinalization();
  Reference ref=queue.remove(10 * 1000);
  assertNotNull("Object not enqueued.",ref);
  assertSame("Unexpected ref1",ref,r);
  assertNull("Object could not be reclaimed1.",r.get());
  r=newWeakReference(queue);
  System.gc();
  System.runFinalization();
  Thread.yield();
  Thread.sleep(200);
  ref=queue.poll();
  assertNotNull("Object not enqueued.",ref);
  assertSame("Unexpected ref2",ref,r);
  assertNull("Object could not be reclaimed.",ref.get());
  assertNull("Object could not be reclaimed.",r.get());
}
