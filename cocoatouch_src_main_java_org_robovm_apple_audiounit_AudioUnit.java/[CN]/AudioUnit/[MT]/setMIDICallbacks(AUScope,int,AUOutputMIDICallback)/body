{
  OSStatus result=null;
  AUOutputMIDICallbacksStruct struct=null;
  if (callback == null) {
    struct=getProperty(AUOutputProperty.MIDICallbacks,scope,element,AUOutputMIDICallbacksStruct.class);
    if (struct != null) {
      setProperty(AUOutputProperty.MIDICallbacks,scope,element,null);
synchronized (midiCallbacks) {
        midiCallbacks.remove(struct.getUserData());
      }
    }
  }
 else {
    long cid=callbackId.getAndIncrement();
    struct=new AUOutputMIDICallbacksStruct(cid,new FunctionPtr(cbMIDIEvent),new FunctionPtr(cbMIDISysEx));
    result=setProperty(AUOutputProperty.MIDICallbacks,scope,element,struct);
    if (result.equals(0)) {
synchronized (midiCallbacks) {
        midiCallbacks.put(cid,callback);
      }
    }
  }
  return result;
}
