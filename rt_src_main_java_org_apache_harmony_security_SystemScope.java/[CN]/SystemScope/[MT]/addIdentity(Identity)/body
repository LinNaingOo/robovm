{
  if (identity == null) {
    throw new NullPointerException(Messages.getString("security.92"));
  }
  String name=identity.getName();
  if (names.containsKey(name)) {
    throw new KeyManagementException(Messages.getString("security.93",name));
  }
  PublicKey key=identity.getPublicKey();
  if (key != null && keys.containsKey(key)) {
    throw new KeyManagementException(Messages.getString("security.94",key));
  }
  names.put(name,identity);
  if (key != null) {
    keys.put(key,identity);
  }
}
