{
  if (identity == null) {
    throw new NullPointerException(Messages.getString("security.92"));
  }
  String name=identity.getName();
  if (name == null) {
    throw new NullPointerException(Messages.getString("security.95"));
  }
  boolean contains=names.containsKey(name);
  names.remove(name);
  PublicKey key=identity.getPublicKey();
  if (key != null) {
    contains=contains || keys.containsKey(key);
    keys.remove(key);
  }
  if (!contains) {
    throw new KeyManagementException(Messages.getString("security.96"));
  }
}
