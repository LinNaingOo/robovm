{
  for (int i=0; i < offset; i++) {
    if (encoded[i] != 0) {
      throw new Exception("Encoded data is not properly padded at offset " + i);
    }
  }
  for (int i=0; i < original.length; i++) {
    if (original[i] != encoded[i + offset]) {
      throw new Exception("Source and encoded data not match " + getCipherParameters());
    }
  }
}
