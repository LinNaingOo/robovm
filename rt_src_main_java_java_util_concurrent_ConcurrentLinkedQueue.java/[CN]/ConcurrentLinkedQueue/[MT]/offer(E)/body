{
  if (e == null)   throw new NullPointerException();
  Node<E> n=new Node<E>(e);
  retry:   for (; ; ) {
    Node<E> t=tail;
    Node<E> p=t;
    for (int hops=0; ; hops++) {
      Node<E> next=succ(p);
      if (next != null) {
        if (hops > HOPS && t != tail)         continue retry;
        p=next;
      }
 else       if (p.casNext(null,n)) {
        if (hops >= HOPS)         casTail(t,n);
        return true;
      }
 else {
        p=succ(p);
      }
    }
  }
}
