{
  int shift=0;
  do {
    shift=next.matches(stringIndex,testString,matchResult);
    if (shift >= 0) {
      return shift;
    }
    if (stringIndex + leaf.charCount() <= matchResult.getRightBound()) {
      shift=leaf.accepts(stringIndex,testString);
      stringIndex+=shift;
    }
  }
 while (shift >= 1);
  return -1;
}
