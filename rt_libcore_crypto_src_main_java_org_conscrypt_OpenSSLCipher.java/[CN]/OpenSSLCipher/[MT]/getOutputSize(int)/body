{
  if (modeBlockSize == 1) {
    return inputLen;
  }
 else {
    final int buffered=NativeCrypto.get_EVP_CIPHER_CTX_buf_len(cipherCtx.getContext());
    if (padding == Padding.NOPADDING) {
      return buffered + inputLen;
    }
 else {
      final int totalLen=inputLen + buffered + modeBlockSize;
      return totalLen - (totalLen % modeBlockSize);
    }
  }
}
