{
  String iosSimPath="ios-sim";
  if (iosSimBinPath != null) {
    iosSimPath=iosSimBinPath.getAbsolutePath();
  }
  List<SDK> sdks=new ArrayList<SDK>();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ExecuteStreamHandler streamHandler=new PumpStreamHandler(baos);
  Executor executor=new DefaultExecutor();
  executor.setStreamHandler(streamHandler);
  CommandLine command=new CommandLine(iosSimPath).addArgument("showsdks");
  try {
    @SuppressWarnings("rawtypes") Map env=EnvironmentUtils.getProcEnvironment();
    executor.setExitValues(new int[]{0,1});
    executor.execute(command,env);
    String output=new String(baos.toByteArray());
    String[] lines=output.split("\n");
    for (int i=1; i < lines.length; i+=2) {
      String nameVersion=lines[i];
      if (nameVersion.startsWith("[DEBUG]")) {
        nameVersion=nameVersion.substring(7);
      }
      nameVersion=nameVersion.trim();
      String name=nameVersion.replaceAll(".*'([^']*)'.*","$1");
      String version=nameVersion.replaceAll(".*\\(([^)]*)\\).*","$1");
      String root=lines[i + 1].trim();
      sdks.add(new SDK(name,version,new File(root)));
    }
  }
 catch (  Throwable t) {
    throw new RuntimeException(t);
  }
  return sdks;
}
