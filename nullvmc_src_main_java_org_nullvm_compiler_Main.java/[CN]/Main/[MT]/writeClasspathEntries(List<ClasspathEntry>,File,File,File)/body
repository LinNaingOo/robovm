{
  PrintWriter writer=null;
  try {
    writer=new PrintWriter(new OutputStreamWriter(new FileOutputStream(file),"UTF-8"));
    for (    ClasspathEntry entry : entries) {
      String left=entry.getArchive().getCanonicalPath();
      String right=entry.getDynamicLibrary().getCanonicalPath();
      if (installPath != null) {
        String dir=installPath.getAbsolutePath().substring(basePath.getAbsolutePath().length() + 1);
        stripArchive(entry.getArchive(),new File(installPath,entry.getArchive().getName()));
        FileUtils.copyFileToDirectory(entry.getDynamicLibrary(),installPath);
        left=dir + File.separator + entry.getArchive().getName();
        right=dir + File.separator + entry.getDynamicLibrary().getName();
      }
      writer.write(left);
      writer.write('=');
      writer.write(right);
      writer.write('\n');
    }
  }
  finally {
    IOUtils.closeQuietly(writer);
  }
}
