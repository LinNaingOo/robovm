{
  byte[] b=engineDoFinal(input,inputOffset,inputLen);
  final int lastOffset=outputOffset + b.length;
  if (lastOffset > output.length) {
    throw new ShortBufferException("output buffer is too small " + output.length + " < "+ lastOffset);
  }
  System.arraycopy(b,0,output,outputOffset,b.length);
  return b.length;
}
