{
  if (!objectsWritten.isEmpty()) {
    throw new IllegalStateException(Messages.getString("luni.C8"));
  }
  if (version != ObjectStreamConstants.PROTOCOL_VERSION_1 && version != ObjectStreamConstants.PROTOCOL_VERSION_2) {
    throw new IllegalArgumentException(Messages.getString("luni.9C",version));
  }
  protocolVersion=version;
}
