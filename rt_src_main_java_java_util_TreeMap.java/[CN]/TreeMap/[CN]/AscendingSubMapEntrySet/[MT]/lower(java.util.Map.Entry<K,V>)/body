{
  Comparator<? super K> cmp=map.m.comparator;
  if (cmp == null) {
    Comparable<K> object=toComparable(e.getKey());
    if (hasStart && object.compareTo(startEntry.getKey()) < 0) {
      return null;
    }
    if (hasEnd && object.compareTo(lastentry.getKey()) >= 0) {
      return map.lowerEntry(lastentry.getKey());
    }
  }
 else {
    if (hasStart && cmp.compare(e.getKey(),startEntry.getKey()) < 0) {
      return null;
    }
    if (hasEnd && cmp.compare(e.getKey(),lastentry.getKey()) >= 0) {
      return map.lowerEntry(lastentry.getKey());
    }
  }
  return map.lowerEntry(e.getKey());
}
