{
  boolean isInRange=true;
  int result;
  if (map.toEnd) {
    result=(null != comparator()) ? comparator().compare(end,map.hi) : toComparable(end).compareTo(map.hi);
    isInRange=(map.hiInclusive || !endInclusive) ? result <= 0 : result < 0;
  }
  if (map.fromStart) {
    result=(null != comparator()) ? comparator().compare(end,map.lo) : toComparable(end).compareTo(map.lo);
    isInRange=isInRange && ((map.loInclusive || !endInclusive) ? result >= 0 : result > 0);
  }
  if (isInRange) {
    if (map.fromStart) {
      return new AscendingSubMapKeySet<K,V>(new AscendingSubMap<K,V>(map.lo,map.loInclusive,map.m,end,endInclusive));
    }
 else {
      return new AscendingSubMapKeySet<K,V>(new AscendingSubMap<K,V>(map.m,end,endInclusive));
    }
  }
  throw new IllegalArgumentException();
}
