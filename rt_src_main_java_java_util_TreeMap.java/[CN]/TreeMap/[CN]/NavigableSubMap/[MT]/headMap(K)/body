{
  if (toEnd) {
    int result=(null != comparator()) ? comparator().compare(end,hi) : toComparable(end).compareTo(hi);
    if (result > 0) {
      throw new IllegalArgumentException();
    }
  }
  if (fromStart) {
    int result=-((null != comparator()) ? comparator().compare(lo,end) : toComparable(lo).compareTo(end));
    if (result < 0) {
      throw new IllegalArgumentException();
    }
  }
  return headMap(end,false);
}
