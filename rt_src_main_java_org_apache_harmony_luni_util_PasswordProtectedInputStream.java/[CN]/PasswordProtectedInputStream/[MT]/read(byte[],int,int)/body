{
  int read=in.read(b,off,len);
  if (read > 0) {
    int lastIndex=off + read;
    for (int i=off; i < lastIndex; i++) {
      b[i]^=password[pwdIndex];
      pwdIndex=(pwdIndex + 1) % password.length;
    }
  }
  return read;
}
