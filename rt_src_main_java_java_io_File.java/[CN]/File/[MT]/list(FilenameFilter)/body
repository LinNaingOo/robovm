{
  SecurityManager security=System.getSecurityManager();
  if (security != null) {
    security.checkRead(path);
  }
  if (path.length() == 0) {
    return null;
  }
  byte[] bs=properPath(true);
  if (!isDirectoryImpl(bs) || !existsImpl(bs) || isWriteOnlyImpl(bs)) {
    return null;
  }
  byte[][] implList=listImpl(bs);
  if (implList == null) {
    return new String[0];
  }
  List<String> tempResult=new ArrayList<String>();
  for (int index=0; index < implList.length; index++) {
    String aName=Util.toString(implList[index]);
    if (filter == null || filter.accept(this,aName)) {
      tempResult.add(aName);
    }
  }
  return tempResult.toArray(new String[tempResult.size()]);
}
