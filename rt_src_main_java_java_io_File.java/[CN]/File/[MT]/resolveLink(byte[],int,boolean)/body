{
  boolean restart=false;
  byte[] linkBytes, temp;
  do {
    linkBytes=getLinkImpl(pathBytes);
    if (linkBytes == pathBytes) {
      break;
    }
    if (linkBytes[0] == separatorChar) {
      restart=resolveAbsolute;
      pathBytes=linkBytes;
    }
 else {
      int last=length - 1;
      while (pathBytes[last] != separatorChar) {
        last--;
      }
      last++;
      temp=new byte[last + linkBytes.length];
      System.arraycopy(pathBytes,0,temp,0,last);
      System.arraycopy(linkBytes,0,temp,last,linkBytes.length);
      pathBytes=temp;
    }
    length=pathBytes.length;
  }
 while (existsImpl(pathBytes));
  if (restart) {
    return resolve(pathBytes);
  }
  return pathBytes;
}
