{
  List<Type> types=new ArrayList<Type>();
  for (  StructMemberPair pair : getStructMemberPairs(clazz)) {
    SootMethod getter=pair.getter;
    SootMethod setter=pair.setter;
    soot.Type type=getter != null ? getter.getReturnType() : setter.getParameterType(0);
    if (isStruct(type)) {
      boolean byVal=getter != null ? isPassByValue(getter) : isPassByValue(setter,0);
      if (!byVal) {
        types.add(I8_PTR);
      }
 else {
        try {
          types.add(getStructType(type));
        }
 catch (        StackOverflowError e) {
          throw new IllegalArgumentException("Struct type " + type + " refers to itself");
        }
      }
    }
 else     if (isEnum(type)) {
      types.add(I32);
    }
 else     if (isNativeObject(type)) {
      types.add(I8_PTR);
    }
 else     if (getter != null && hasPointerAnnotation(getter) || hasPointerAnnotation(setter)) {
      types.add(I8_PTR);
    }
 else {
      types.add(getType(type));
    }
  }
  if (types.isEmpty()) {
    throw new IllegalArgumentException("Struct class " + clazz + " has no @StructMember annotated methods");
  }
  return new StructureType(types.toArray(new Type[types.size()]));
}
