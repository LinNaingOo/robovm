{
  if (totalLength == 0) {
    initCipher();
  }
  gCTRBlock(bufBlock,output,offset);
  if (forEncryption) {
    bufOff=0;
  }
 else {
    System.arraycopy(bufBlock,BLOCK_SIZE,bufBlock,0,macSize);
    bufOff=macSize;
  }
}
