{
  if (nbytes < 1) {
    return 0;
  }
  long skipped=0;
  byte[] b=new byte[(int)Math.min(nbytes,2048L)];
  int x, v;
  while (skipped != nbytes) {
    x=in.read(b,0,(v=(int)(nbytes - skipped)) > b.length ? b.length : v);
    if (x == -1) {
      return skipped;
    }
    check.update(b,0,x);
    skipped+=x;
  }
  return skipped;
}
