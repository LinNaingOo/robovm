{
  int flags=((IntConstant)bsmArgs.get(3)).value;
  List<Object> args=new ArrayList<>();
  args.add(samMethodType);
  args.add(implMethod);
  args.add(instantiatedMethodType);
  args.add(flags);
  int bsmArgsIdx=4;
  if ((flags & LambdaMetafactory.FLAG_MARKERS) > 0) {
    int count=((IntConstant)bsmArgs.get(bsmArgsIdx++)).value;
    args.add(count);
    for (int i=0; i < count; i++) {
      Value value=bsmArgs.get(bsmArgsIdx++);
      Object arg=null;
      if (value instanceof Type) {
        arg=SootSClass.forType((soot.Type)value);
      }
 else       if (value instanceof ClassConstant) {
        arg=SootSClass.forType(((ClassConstant)value).getValue());
      }
 else {
        throw new CompilerException("Unknown marker interface type found in Jimple: " + value.getClass());
      }
      args.add(arg);
    }
  }
  if ((flags & LambdaMetafactory.FLAG_BRIDGES) > 0) {
    int count=((IntConstant)bsmArgs.get(bsmArgsIdx++)).value;
    args.add(count);
    for (int i=0; i < count; i++) {
      args.add(toSMethodType((SootMethodType)bsmArgs.get(bsmArgsIdx++)));
    }
  }
  return LambdaMetafactory.altMetafactory(caller,invokedName,invokedType,args.toArray());
}
