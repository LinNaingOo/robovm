{
  if (mode != ENCRYPT_MODE && mode != DECRYPT_MODE) {
    throw new IllegalStateException();
  }
  if (input == null) {
    throw new IllegalArgumentException("input == null");
  }
  checkInputOffsetAndCount(input.length,inputOffset,inputLen);
  if (input.length == 0) {
    return null;
  }
  return spiImpl.engineUpdate(input,inputOffset,inputLen);
}
