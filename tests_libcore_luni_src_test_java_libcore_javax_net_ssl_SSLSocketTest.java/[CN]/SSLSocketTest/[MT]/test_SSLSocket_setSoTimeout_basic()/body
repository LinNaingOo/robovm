{
  ServerSocket listening=new ServerSocket(0);
  Socket underlying=new Socket(listening.getInetAddress(),listening.getLocalPort());
  assertEquals(0,underlying.getSoTimeout());
  SSLSocketFactory sf=(SSLSocketFactory)SSLSocketFactory.getDefault();
  Socket wrapping=sf.createSocket(underlying,null,-1,false);
  assertEquals(0,wrapping.getSoTimeout());
  int expectedTimeoutMillis=1000;
  wrapping.setSoTimeout(expectedTimeoutMillis);
  assertEquals(expectedTimeoutMillis,wrapping.getSoTimeout());
  assertEquals(expectedTimeoutMillis,underlying.getSoTimeout());
  underlying.setSoTimeout(0);
  assertEquals(0,wrapping.getSoTimeout());
  assertEquals(0,underlying.getSoTimeout());
}
