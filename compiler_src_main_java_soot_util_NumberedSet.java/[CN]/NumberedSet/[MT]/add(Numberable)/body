{
  if (array != null) {
    int pos=findPosition(o);
    if (array[pos] == o)     return false;
    size++;
    if (size * 3 > array.length * 2) {
      doubleSize();
      if (array != null) {
        pos=findPosition(o);
      }
 else {
        int number=o.getNumber();
        if (number == 0)         throw new RuntimeException("unnumbered");
        return bits.set(number);
      }
    }
    array[pos]=o;
    return true;
  }
 else {
    int number=o.getNumber();
    if (number == 0)     throw new RuntimeException("unnumbered");
    if (bits.set(number)) {
      size++;
      return true;
    }
 else {
      return false;
    }
  }
}
