{
  List<AnnotationTag> tags=new ArrayList<AnnotationTag>();
  AnnotationTag marshaler=getAnnotation(clazz,MARSHALER);
  if (marshaler != null) {
    tags.add(marshaler);
  }
 else {
    AnnotationTag marshalers=getAnnotation(clazz,MARSHALERS);
    if (marshalers != null) {
      for (      AnnotationElem e : ((AnnotationArrayElem)marshalers.getElemAt(0)).getValues()) {
        AnnotationAnnotationElem elem=(AnnotationAnnotationElem)e;
        tags.add(elem.getValue());
      }
    }
  }
  for (  AnnotationTag tag : tags) {
    AnnotationClassElem elem=(AnnotationClassElem)getElemByName(tag,"type");
    if (elem == null && type == null) {
      return tag;
    }
    if (elem != null && type != null) {
      String desc=elem.getDesc();
      if (type instanceof ArrayType) {
        if (getInternalName(type).equals(desc)) {
          return tag;
        }
      }
 else       if (getInternalName(type).equals(getInternalNameFromDescriptor(desc))) {
        return tag;
      }
    }
  }
  if (type instanceof ArrayType) {
    ArrayType arrayType=(ArrayType)type;
    if (arrayType.baseType instanceof RefType && ((RefType)arrayType.baseType).getSootClass().hasSuperclass()) {
      Type newType=((RefType)arrayType.baseType).getSootClass().getSuperclass().getType();
      for (int i=0; i < arrayType.numDimensions; i++) {
        newType=newType.makeArrayType();
      }
      return getMarshalerAnnotation0(clazz,newType);
    }
  }
  return null;
}
