{
  int startClean=lastDirty + 1;
  if (i > startClean) {
    int lengthClean=i - startClean;
    m_writer.write(chars,startClean,lengthClean);
  }
  if (CharInfo.S_LINEFEED == ch && fromTextNode) {
    m_writer.write(m_lineSep,0,m_lineSepLen);
  }
 else {
    startClean=accumDefaultEscape(m_writer,(char)ch,i,chars,end,fromTextNode,false);
    i=startClean - 1;
  }
  return i;
}
