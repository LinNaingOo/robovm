{
  int nodeIndex=m_size++;
  if (m_dtmIdent.size() == (nodeIndex >>> DTMManager.IDENT_DTM_NODE_BITS)) {
    addNewDTMID(nodeIndex);
  }
  m_firstch.addElement(canHaveFirstChild ? NOTPROCESSED : DTM.NULL);
  m_nextsib.addElement(NOTPROCESSED);
  m_parent.addElement(parentIndex);
  m_exptype.addElement(expandedTypeID);
  m_dataOrQName.addElement(dataOrPrefix);
  if (m_prevsib != null) {
    m_prevsib.addElement(previousSibling);
  }
  if (DTM.NULL != previousSibling) {
    m_nextsib.setElementAt(nodeIndex,previousSibling);
  }
  if (m_locator != null && m_useSourceLocationProperty) {
    setSourceLocation();
  }
switch (type) {
case DTM.NAMESPACE_NODE:
    declareNamespaceInContext(parentIndex,nodeIndex);
  break;
case DTM.ATTRIBUTE_NODE:
break;
default :
if (DTM.NULL == previousSibling && DTM.NULL != parentIndex) {
m_firstch.setElementAt(nodeIndex,parentIndex);
}
break;
}
return nodeIndex;
}
