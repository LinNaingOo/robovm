{
  List<Unit> tailList=new ArrayList<Unit>();
  List<Unit> headList=new ArrayList<Unit>();
  for (Iterator<Unit> unitIt=unitChain.iterator(); unitIt.hasNext(); ) {
    Unit s=(Unit)unitIt.next();
    List<Unit> succs=unitToSuccs.get(s);
    if (succs.size() == 0) {
      tailList.add(s);
    }
    List<Unit> preds=unitToPreds.get(s);
    if (preds.size() == 0) {
      headList.add(s);
    }
  }
  Unit entryPoint=(Unit)unitChain.getFirst();
  if (!headList.contains(entryPoint)) {
    headList.add(entryPoint);
  }
  tails=Collections.unmodifiableList(tailList);
  heads=Collections.unmodifiableList(headList);
}
