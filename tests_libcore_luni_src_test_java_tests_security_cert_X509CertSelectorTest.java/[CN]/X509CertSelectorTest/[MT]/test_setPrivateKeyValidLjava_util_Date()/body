{
  Date date1=new Date(100000000);
  Date date2=new Date(200000000);
  Date date3=new Date(300000000);
  Date date4=new Date(150000000);
  Date date5=new Date(250000000);
  TestCert cert1=new TestCert(date1,date2);
  TestCert cert2=new TestCert(date2,date3);
  X509CertSelector selector=new X509CertSelector();
  selector.setPrivateKeyValid(null);
  assertTrue("Any certificate should match in the case of null " + "privateKeyValid criteria.",selector.match(cert1) && selector.match(cert2));
  selector.setPrivateKeyValid(date4);
  assertTrue("The certificate should match the selection criteria.",selector.match(cert1));
  assertFalse("The certificate should not match the selection criteria.",selector.match(cert2));
  selector.setPrivateKeyValid(date5);
  date5.setTime(date4.getTime());
  assertTrue("The certificate should match the selection criteria.",selector.match(cert2));
}
