{
  int size=in.readUint8();
  certificate_types=new byte[size];
  in.read(certificate_types,0,size);
  size=in.readUint16();
  certificate_authorities=new X500Principal[size];
  int totalPrincipalsLength=0;
  int principalLength=0;
  Vector<X500Principal> principals=new Vector<X500Principal>();
  while (totalPrincipalsLength < size) {
    principalLength=in.readUint16();
    principals.add(new X500Principal(in));
    totalPrincipalsLength+=2;
    totalPrincipalsLength+=principalLength;
  }
  certificate_authorities=new X500Principal[principals.size()];
  for (int i=0; i < certificate_authorities.length; i++) {
    certificate_authorities[i]=principals.elementAt(i);
  }
  this.length=3 + certificate_types.length + totalPrincipalsLength;
  if (this.length != length) {
    fatalAlert(AlertProtocol.DECODE_ERROR,"DECODE ERROR: incorrect CertificateRequest");
  }
}
