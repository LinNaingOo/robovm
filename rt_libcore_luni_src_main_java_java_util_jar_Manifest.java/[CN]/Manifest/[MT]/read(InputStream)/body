{
  byte[] buf;
  if (is instanceof ByteArrayInputStream) {
    buf=exposeByteArrayInputStreamBytes((ByteArrayInputStream)is);
  }
 else {
    buf=Streams.readFullyNoClose(is);
  }
  if (buf.length == 0) {
    return;
  }
  byte b=buf[buf.length - 1];
  if (b == 0 || b == 26) {
    buf[buf.length - 1]='\n';
  }
  ManifestReader im=new ManifestReader(buf,mainAttributes);
  mainEnd=im.getEndOfMainSection();
  im.readEntries(entries,chunks);
}
