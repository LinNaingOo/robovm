{
  s.defaultReadObject();
  int cap=MIN_SEGMENT_TABLE_CAPACITY;
  final Segment<K,V>[] segments=this.segments;
  for (int k=0; k < segments.length; ++k) {
    Segment<K,V> seg=segments[k];
    if (seg != null) {
      seg.threshold=(int)(cap * seg.loadFactor);
      seg.table=(HashEntry<K,V>[])new HashEntry<?,?>[cap];
    }
  }
  for (; ; ) {
    K key=(K)s.readObject();
    V value=(V)s.readObject();
    if (key == null)     break;
    put(key,value);
  }
}
