{
  int hash=hash(key.hashCode());
  if (value == null)   throw new NullPointerException();
  Segment<K,V> s=segmentForHash(hash);
  return s == null ? null : s.replace(key,hash,value);
}
