{
  SecurityManager sm=System.getSecurityManager();
  if (sm != null) {
    sm.checkSecurityAccess("addIdentityCertificate");
  }
  PublicKey certPK=certificate.getPublicKey();
  if (publicKey != null) {
    if (!checkKeysEqual(publicKey,certPK)) {
      throw new KeyManagementException(Messages.getString("security.13"));
    }
  }
 else {
    publicKey=certPK;
  }
  if (certificates == null) {
    certificates=new Vector<Certificate>();
  }
  certificates.add(certificate);
}
