{
  if (seq == null) {
    throw new NullPointerException();
  }
  int len=seq.length;
  int endIndex=offset + count;
  if (offset < 0 || count < 0 || endIndex > len) {
    throw new IndexOutOfBoundsException();
  }
  int result=0;
  for (int i=offset; i < endIndex; i++) {
    char c=seq[i];
    if (isHighSurrogate(c)) {
      if (++i < endIndex) {
        c=seq[i];
        if (!isLowSurrogate(c)) {
          result++;
        }
      }
    }
    result++;
  }
  return result;
}
