{
  int nodeIndex=m_size++;
  if (nodeIndex == m_maxNodeIndex) {
    addNewDTMID(nodeIndex);
    m_maxNodeIndex+=(1 << DTMManager.IDENT_DTM_NODE_BITS);
  }
  m_firstch.addElement(DTM.NULL);
  m_nextsib.addElement(DTM.NULL);
  m_parent.addElement(parentIndex);
  m_exptype.addElement(expandedTypeID);
  m_dataOrQName.addElement(dataOrPrefix);
  if (m_prevsib != null) {
    m_prevsib.addElement(previousSibling);
  }
  if (m_locator != null && m_useSourceLocationProperty) {
    setSourceLocation();
  }
switch (type) {
case DTM.NAMESPACE_NODE:
    declareNamespaceInContext(parentIndex,nodeIndex);
  break;
case DTM.ATTRIBUTE_NODE:
break;
default :
if (DTM.NULL != previousSibling) {
m_nextsib.setElementAt(nodeIndex,previousSibling);
}
 else if (DTM.NULL != parentIndex) {
m_firstch.setElementAt(nodeIndex,parentIndex);
}
break;
}
return nodeIndex;
}
