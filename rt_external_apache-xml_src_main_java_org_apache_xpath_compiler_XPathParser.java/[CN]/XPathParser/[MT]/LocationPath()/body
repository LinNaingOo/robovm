{
  int opPos=m_ops.getOp(OpMap.MAPINDEX_LENGTH);
  appendOp(2,OpCodes.OP_LOCATIONPATH);
  boolean seenSlash=tokenIs('/');
  if (seenSlash) {
    appendOp(4,OpCodes.FROM_ROOT);
    m_ops.setOp(m_ops.getOp(OpMap.MAPINDEX_LENGTH) - 2,4);
    m_ops.setOp(m_ops.getOp(OpMap.MAPINDEX_LENGTH) - 1,OpCodes.NODETYPE_ROOT);
    nextToken();
  }
 else   if (m_token == null) {
    error(XPATHErrorResources.ER_EXPECTED_LOC_PATH_AT_END_EXPR,null);
  }
  if (m_token != null) {
    if (!RelativeLocationPath() && !seenSlash) {
      error(XPATHErrorResources.ER_EXPECTED_LOC_PATH,new Object[]{m_token});
    }
  }
  m_ops.setOp(m_ops.getOp(OpMap.MAPINDEX_LENGTH),OpCodes.ENDOP);
  m_ops.setOp(OpMap.MAPINDEX_LENGTH,m_ops.getOp(OpMap.MAPINDEX_LENGTH) + 1);
  m_ops.setOp(opPos + OpMap.MAPINDEX_LENGTH,m_ops.getOp(OpMap.MAPINDEX_LENGTH) - opPos);
}
