{
  Signature signature;
  try {
    if (sigProvider == null) {
      signature=Signature.getInstance(getSigAlgName(),OpenSSLProvider.PROVIDER_NAME);
    }
 else {
      signature=Signature.getInstance(getSigAlgName(),sigProvider);
    }
  }
 catch (  NoSuchAlgorithmException ignored) {
    signature=Signature.getInstance(getSigAlgName(),sigProvider);
  }
  signature.initVerify(key);
  byte[] tbsCertificateLocal=getTbsCertificateInternal();
  signature.update(tbsCertificateLocal,0,tbsCertificateLocal.length);
  if (!signature.verify(certificate.getSignatureValue())) {
    throw new SignatureException("Signature was not verified");
  }
}
