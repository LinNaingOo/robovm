{
  if (notBefore == -1) {
    notBefore=tbsCert.getValidity().getNotBefore().getTime();
    notAfter=tbsCert.getValidity().getNotAfter().getTime();
  }
  long time=date.getTime();
  if (time < notBefore) {
    throw new CertificateNotYetValidException();
  }
  if (time > notAfter) {
    throw new CertificateExpiredException();
  }
}
