{
  CoderResult result=encoder.encode(chars,bytes,true);
  encoderFlush=true;
  while (true) {
    if (result.isError()) {
      throw new IOException(result.toString());
    }
 else     if (result.isOverflow()) {
      flush();
      result=encoder.encode(chars,bytes,true);
      continue;
    }
    break;
  }
}
