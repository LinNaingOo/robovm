{
  element_value[] list=new element_value[count];
  for (int x=0; x < count; x++) {
    if (needName) {
      name_index=d.readUnsignedShort();
    }
    int tag=d.readUnsignedByte();
    char kind=(char)tag;
    if (kind == 'B' || kind == 'C' || kind == 'D' || kind == 'F' || kind == 'I' || kind == 'J' || kind == 'S' || kind == 'Z' || kind == 's') {
      constant_element_value elem=new constant_element_value();
      elem.name_index=name_index;
      elem.tag=kind;
      elem.constant_value_index=d.readUnsignedShort();
      list[x]=elem;
    }
 else     if (kind == 'e') {
      enum_constant_element_value elem=new enum_constant_element_value();
      elem.name_index=name_index;
      elem.tag=kind;
      elem.type_name_index=d.readUnsignedShort();
      elem.constant_name_index=d.readUnsignedShort();
      list[x]=elem;
    }
 else     if (kind == 'c') {
      class_element_value elem=new class_element_value();
      elem.name_index=name_index;
      elem.tag=kind;
      elem.class_info_index=d.readUnsignedShort();
      list[x]=elem;
    }
 else     if (kind == '[') {
      array_element_value elem=new array_element_value();
      elem.name_index=name_index;
      elem.tag=kind;
      elem.num_values=d.readUnsignedShort();
      elem.values=readElementValues(elem.num_values,d,false,name_index);
      list[x]=elem;
    }
 else     if (kind == '@') {
      annotation_element_value elem=new annotation_element_value();
      elem.name_index=name_index;
      elem.tag=kind;
      annotation annot=new annotation();
      annot.type_index=d.readUnsignedShort();
      annot.num_element_value_pairs=d.readUnsignedShort();
      annot.element_value_pairs=readElementValues(annot.num_element_value_pairs,d,true,0);
      elem.annotation_value=annot;
      list[x]=elem;
    }
 else {
      throw new RuntimeException("Unknown element value pair kind: " + kind);
    }
  }
  return list;
}
