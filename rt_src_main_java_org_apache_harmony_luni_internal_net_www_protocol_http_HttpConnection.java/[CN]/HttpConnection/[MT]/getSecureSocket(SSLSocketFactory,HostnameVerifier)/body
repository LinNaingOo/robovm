{
  if (!usingSecureSocket) {
    String hostName=config.getHostName();
    int port=config.getHostPort();
    sslSocket=(SSLSocket)sslSocketFactory.createSocket(socket,hostName,port,true);
    sslSocket.setUseClientMode(true);
    sslSocket.startHandshake();
    if (!hostnameVerifier.verify(hostName,sslSocket.getSession())) {
      throw new IOException(Messages.getString("luni.02",hostName));
    }
    usingSecureSocket=true;
  }
  return sslSocket;
}
