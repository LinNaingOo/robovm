{
  boolean changed;
  do {
    changed=false;
    NullnessAnalysis analysis=analysisFactory.newAnalysis(new ExceptionalUnitGraph(body));
    Chain units=body.getUnits();
    Stmt s;
    for (s=(Stmt)units.getFirst(); s != null; s=(Stmt)units.getSuccOf(s)) {
      if (!(s instanceof IfStmt))       continue;
      IfStmt is=(IfStmt)s;
      Value c=is.getCondition();
      if (!(c instanceof EqExpr || c instanceof NeExpr))       continue;
      BinopExpr e=(BinopExpr)c;
      Immediate i=null;
      if (e.getOp1() instanceof NullConstant)       i=(Immediate)e.getOp2();
      if (e.getOp2() instanceof NullConstant)       i=(Immediate)e.getOp1();
      if (i == null)       continue;
      boolean alwaysNull=analysis.isAlwaysNullBefore(s,i);
      boolean alwaysNonNull=analysis.isAlwaysNonNullBefore(s,i);
      int elim=0;
      if (alwaysNonNull)       elim=c instanceof EqExpr ? -1 : 1;
      if (alwaysNull)       elim=c instanceof EqExpr ? 1 : -1;
      Stmt newstmt=null;
      if (elim == -1)       newstmt=Jimple.v().newNopStmt();
      if (elim == 1)       newstmt=Jimple.v().newGotoStmt(is.getTarget());
      if (newstmt != null) {
        units.swapWith(s,newstmt);
        s=newstmt;
        changed=true;
      }
    }
  }
 while (changed);
}
