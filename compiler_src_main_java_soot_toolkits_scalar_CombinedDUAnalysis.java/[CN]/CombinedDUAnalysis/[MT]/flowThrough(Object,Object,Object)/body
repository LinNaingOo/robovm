{
  Unit u=(Unit)unit;
  FlowSet in=(FlowSet)inValue;
  FlowSet out=(FlowSet)outValue;
  Local def=localDefed(u);
  out.copy(in);
  if (def != null) {
    Collection boxesDefed=localToUseBoxes.get(def);
    for (Iterator vbIt=in.toList().iterator(); vbIt.hasNext(); ) {
      final ValueBox vb=(ValueBox)vbIt.next();
      if (boxesDefed.contains(vb))       in.remove(vb);
    }
  }
  in.union(unitToLocalUseBoxes.get(u));
}
