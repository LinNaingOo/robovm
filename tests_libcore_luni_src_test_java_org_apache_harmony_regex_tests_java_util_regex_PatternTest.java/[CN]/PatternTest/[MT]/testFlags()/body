{
  String baseString;
  String testString;
  Pattern pat;
  Matcher mat;
  baseString="((?i)|b)a";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
  baseString="(?i)a|b";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)a|b";
  testString="B";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="c|(?i)a|b";
  testString="B";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)a|(?s)b";
  testString="B";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)a|(?-i)b";
  testString="B";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
  baseString="(?i)a|(?-i)c|b";
  testString="B";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
  baseString="(?i)a|(?-i)c|(?i)b";
  testString="B";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)a|(?-i)b";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="((?i))a";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
  baseString="|(?i)|a";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)((?s)a.)";
  testString="A\n";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)((?-i)a)";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
  baseString="(?i)(?s:a.)";
  testString="A\n";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)fgh(?s:aa)";
  testString="fghAA";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="(?i)((?-i))a";
  testString="A";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="abc(?i)d";
  testString="ABCD";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
  testString="abcD";
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  baseString="a(?i)a(?-i)a(?i)a(?-i)a";
  testString="aAaAa";
  pat=Pattern.compile(baseString);
  mat=pat.matcher(testString);
  assertTrue(mat.matches());
  testString="aAAAa";
  mat=pat.matcher(testString);
  assertFalse(mat.matches());
}
