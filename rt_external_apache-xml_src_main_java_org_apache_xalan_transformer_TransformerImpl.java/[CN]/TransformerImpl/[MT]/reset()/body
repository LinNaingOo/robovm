{
  if (!m_hasBeenReset && m_shouldReset) {
    m_hasBeenReset=true;
    if (this.m_outputStream != null) {
      try {
        m_outputStream.close();
      }
 catch (      java.io.IOException ioe) {
      }
    }
    m_outputStream=null;
    m_countersTable=null;
    m_xcontext.reset();
    m_xcontext.getVarStack().reset();
    resetUserParameters();
    m_currentTemplateElements.removeAllElements();
    m_currentMatchTemplates.removeAllElements();
    m_currentMatchedNodes.removeAllElements();
    m_serializationHandler=null;
    m_outputTarget=null;
    m_keyManager=new KeyManager();
    m_attrSetStack=null;
    m_countersTable=null;
    m_currentTemplateRuleIsNull=new BoolStack();
    m_doc=DTM.NULL;
    m_transformThread=null;
    m_xcontext.getSourceTreeManager().reset();
  }
}
