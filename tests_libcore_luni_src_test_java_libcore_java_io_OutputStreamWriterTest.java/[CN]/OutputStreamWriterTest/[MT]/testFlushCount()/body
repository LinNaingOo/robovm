{
  FlushCountingOutputStream os=new FlushCountingOutputStream();
  OutputStreamWriter writer=new OutputStreamWriter(os,"UTF-8");
  char[] chars=new char[16 * 1024];
  Arrays.fill(chars,'x');
  for (int i=0; i < 10; ++i) {
    writer.write(chars);
  }
  assertEquals(0,os.flushCount);
  writer.flush();
  assertEquals(1,os.flushCount);
  writer.close();
  assertEquals(1,os.flushCount);
}
