{
  if (sp + n > max_stack()) {
    throw new verify.VerificationException("stack overflow: dupx(" + n + ","+ x+ ")");
  }
  if (sp - (n + x) < 0) {
    throw new verify.VerificationException("stack underflow: dupx(" + n + ","+ x+ ")");
  }
  Type[] wstate=storage;
  sp+=n;
  int top=sp - 1;
  for (int i=0; i < n + x; i++) {
    wstate[(top - i)]=wstate[(top - i) - n];
  }
  for (int i=0; i < n; i++) {
    wstate[top - (n + x) - i]=wstate[top - i];
  }
}
