{
  if (key_chain.contains(key)) {
    Object old_value=content_map.get(key);
    if (old_value == value)     return value;
    HashChain kc=(HashChain)back_map.get(old_value);
    kc.remove(key);
    if (kc.isEmpty()) {
      value_chain.remove(old_value);
      back_map.remove(old_value);
    }
    kc=(HashChain)back_map.get(value);
    if (kc == null) {
      kc=new HashChain();
      back_map.put(value,kc);
      value_chain.add(value);
    }
    kc.add(key);
    return old_value;
  }
 else {
    key_chain.add(key);
    content_map.put(key,value);
    HashChain kc=(HashChain)back_map.get(value);
    if (kc == null) {
      kc=new HashChain();
      back_map.put(value,kc);
      value_chain.add(value);
    }
    kc.add(key);
    return null;
  }
}
