{
  if (connected) {
    return;
  }
  if (super.usingProxy() && !makingSSLTunnel) {
    makingSSLTunnel=true;
    super.connect();
    String save_meth=method;
    method="CONNECT";
    try {
      doRequest();
      endRequest();
    }
  finally {
      method=save_meth;
    }
    if (!connected) {
      throw new IOException(Messages.getString("luni.01",responseMessage,responseCode));
    }
    InputStream is=connection.getInputStream();
    while (is.available() != 0) {
      is.read();
    }
    makingSSLTunnel=false;
  }
 else {
    super.connect();
  }
  if (!makingSSLTunnel) {
    sslSocket=connection.getSecureSocket(getSSLSocketFactory(),getHostnameVerifier());
    setUpTransportIO(connection);
  }
}
