{
  if (type == null) {
    throw new NullPointerException(Messages.getString("security.07"));
  }
  if (protectionParameter == null) {
    throw new NullPointerException(Messages.getString("security.42"));
  }
  if (file == null) {
    throw new NullPointerException(Messages.getString("security.43"));
  }
  if (!(protectionParameter instanceof PasswordProtection) && !(protectionParameter instanceof CallbackHandlerProtection)) {
    throw new IllegalArgumentException(Messages.getString("security.35"));
  }
  if (!file.exists()) {
    throw new IllegalArgumentException(Messages.getString("security.44",file.getName()));
  }
  if (!file.isFile()) {
    throw new IllegalArgumentException(Messages.getString("security.45",file.getName()));
  }
  return new BuilderImpl(null,protectionParameter,file,type,provider,AccessController.getContext());
}
