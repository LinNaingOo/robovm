{
  Chain<SootClass> processedClasses=new HashChain<SootClass>();
  while (true) {
    Chain<SootClass> unprocessedClasses=new HashChain<SootClass>(getClasses());
    unprocessedClasses.removeAll(processedClasses);
    if (unprocessedClasses.isEmpty())     break;
    processedClasses.addAll(unprocessedClasses);
    for (    SootClass s : unprocessedClasses) {
      if (s.isPhantom())       continue;
      if (Options.v().app()) {
        s.setApplicationClass();
      }
      if (Options.v().classes().contains(s.getName())) {
        s.setApplicationClass();
        continue;
      }
      for (Iterator<String> pkgIt=excludedPackages.iterator(); pkgIt.hasNext(); ) {
        final String pkg=(String)pkgIt.next();
        if (s.isApplicationClass() && (s.getPackageName() + ".").startsWith(pkg)) {
          s.setLibraryClass();
        }
      }
      for (Iterator<String> pkgIt=Options.v().include().iterator(); pkgIt.hasNext(); ) {
        final String pkg=(String)pkgIt.next();
        if ((s.getPackageName() + ".").startsWith(pkg))         s.setApplicationClass();
      }
      if (s.isApplicationClass()) {
        loadClassAndSupport(s.getName());
      }
    }
  }
}
