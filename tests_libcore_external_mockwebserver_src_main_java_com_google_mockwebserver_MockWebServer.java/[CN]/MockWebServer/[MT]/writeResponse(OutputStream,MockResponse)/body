{
  out.write((response.getStatus() + "\r\n").getBytes(ASCII));
  for (  String header : response.getHeaders()) {
    out.write((header + "\r\n").getBytes(ASCII));
  }
  out.write(("\r\n").getBytes(ASCII));
  out.flush();
  final InputStream in=response.getBodyStream();
  if (in == null) {
    return;
  }
  final int bytesPerSecond=response.getBytesPerSecond();
  final byte[] buffer=new byte[1452];
  final long delayMs;
  if (bytesPerSecond == Integer.MAX_VALUE) {
    delayMs=0;
  }
 else {
    delayMs=(1000 * buffer.length) / bytesPerSecond;
  }
  int read;
  long sinceDelay=0;
  while ((read=in.read(buffer)) != -1) {
    out.write(buffer,0,read);
    out.flush();
    sinceDelay+=read;
    if (sinceDelay >= buffer.length && delayMs > 0) {
      sinceDelay%=buffer.length;
      try {
        Thread.sleep(delayMs);
      }
 catch (      InterruptedException e) {
        throw new AssertionError();
      }
    }
  }
}
