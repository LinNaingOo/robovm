{
  Clazz caller=config.getClazzes().load(t.getCallingClass());
  Clazz target=rao.getClazz();
  if (caller == target || rao.isPublic()) {
    return true;
  }
  if (!rao.isPrivate()) {
    if (target.getPackageName().equals(caller.getPackageName())) {
      return true;
    }
    if (rao.isProtected()) {
      if (rao.isStatic()) {
        if (isSubClass(target,caller)) {
          return true;
        }
      }
 else {
        String runtimeClassName=null;
        runtimeClassName=t instanceof Invokevirtual ? ((Invokevirtual)t).getRuntimeClass() : runtimeClassName;
        runtimeClassName=t instanceof Invokespecial ? ((Invokespecial)t).getRuntimeClass() : runtimeClassName;
        runtimeClassName=t instanceof GetField ? ((GetField)t).getRuntimeClass() : runtimeClassName;
        runtimeClassName=t instanceof PutField ? ((PutField)t).getRuntimeClass() : runtimeClassName;
        if (runtimeClassName == null) {
          return true;
        }
        if (isArray(runtimeClassName)) {
          return true;
        }
        Clazz runtimeClass=config.getClazzes().load(runtimeClassName);
        if (runtimeClass == null) {
          return true;
        }
        if (isSubClass(caller,runtimeClass)) {
          return true;
        }
      }
    }
  }
  if (rao instanceof ResolvedMethod) {
    ResolvedMethod rm=(ResolvedMethod)rao;
    throwIllegalAccessError(f,"Attempt to access method %s.%s%s from class %s",target.getClassName(),rm.method.getName(),rm.method.getDesc(),caller);
  }
 else {
    ResolvedField rf=(ResolvedField)rao;
    throwIllegalAccessError(f,"Attempt to access field %s.%s from class %s",target.getClassName(),rf.field.getName(),caller);
  }
  f.add(new Unreachable());
  return false;
}
