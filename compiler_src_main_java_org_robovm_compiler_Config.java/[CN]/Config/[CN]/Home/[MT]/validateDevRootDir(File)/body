{
  String error="Path " + dir + " is not a valid RoboVM source tree: ";
  if (!dir.exists()) {
    throw new IllegalArgumentException(error + "no such path");
  }
  if (!dir.isDirectory()) {
    throw new IllegalArgumentException(error + "not a directory");
  }
  File vmBinariesDir=new File(dir,"vm/target/binaries");
  if (!vmBinariesDir.exists() || !vmBinariesDir.isDirectory()) {
    throw new IllegalArgumentException(error + "vm/target/binaries/ missing or invalid");
  }
  File binDir=new File(dir,"bin");
  if (!binDir.exists() || !binDir.isDirectory()) {
    throw new IllegalArgumentException(error + "bin/ missing or invalid");
  }
  String rtJarName="robovm-rt-" + Version.getVersion() + ".jar";
  File rtJar=new File(dir,"rt/target/" + rtJarName);
  if (!rtJar.exists() || rtJar.isDirectory()) {
    throw new IllegalArgumentException(error + "rt/target/" + rtJarName+ " missing or invalid");
  }
  return new Home(binDir,vmBinariesDir,rtJar);
}
