{
  InetSocketAddress localAddr=new InetSocketAddress("127.0.0.1",Support_PortManager.getNextPort());
  ServerSocketChannel ssc=ServerSocketChannel.open();
  ssc.socket().bind(localAddr);
  SocketChannel sc=SocketChannel.open();
  sc.connect(localAddr);
  sc.configureBlocking(false);
  assertFalse(sc.isBlocking());
  ssc.accept().close();
  ssc.close();
  assertFalse(sc.isBlocking());
  Reader reader=Channels.newReader(sc,"UTF16");
  try {
    int i=reader.read();
    fail("should throw IllegalBlockingModeException");
  }
 catch (  IllegalBlockingModeException expected) {
  }
  try {
    Channels.newInputStream(sc).read();
    fail("should throw IllegalBlockingModeException");
  }
 catch (  IllegalBlockingModeException expected) {
  }
  sc.close();
}
