{
  byte[] b={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20};
  ByteBuffer bInput=ByteBuffer.allocate(64);
  ByteBuffer bOutput=ByteBuffer.allocate(64);
  AlgorithmParameterSpec ap=new IvParameterSpec(IV);
  Cipher c=Cipher.getInstance("DES/CBC/NoPadding");
  c.init(Cipher.ENCRYPT_MODE,CIPHER_KEY_DES,ap);
  bInput.put(b,0,10);
  try {
    c.doFinal(bInput,bOutput);
    fail();
  }
 catch (  IllegalBlockSizeException expected) {
  }
  c=Cipher.getInstance("DES/CBC/NoPadding");
  try {
    c.doFinal(bInput,bOutput);
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  c=Cipher.getInstance("DES/CBC/NoPadding");
  c.init(Cipher.ENCRYPT_MODE,CIPHER_KEY_DES,ap);
  bInput=ByteBuffer.allocate(16);
  bInput.put(b,0,16);
  int len=c.doFinal(bInput,bOutput);
  assertEquals(0,len);
  c=Cipher.getInstance("DES/CBC/PKCS5Padding");
  c.init(Cipher.DECRYPT_MODE,CIPHER_KEY_DES,ap);
  bInput=ByteBuffer.allocate(64);
  try {
    c.doFinal(bOutput,bInput);
    fail();
  }
 catch (  BadPaddingException expected) {
  }
  c=Cipher.getInstance("DES/CBC/NoPadding");
  c.init(Cipher.ENCRYPT_MODE,CIPHER_KEY_DES);
  bInput.put(b,0,16);
  try {
    c.doFinal(bInput,bInput);
    fail();
  }
 catch (  IllegalArgumentException expected) {
  }
  c=Cipher.getInstance("DES/CBC/NoPadding");
  c.init(Cipher.ENCRYPT_MODE,CIPHER_KEY_DES);
  bInput.put(b,0,16);
  try {
    c.doFinal(bInput,bOutput.asReadOnlyBuffer());
    fail();
  }
 catch (  ReadOnlyBufferException expected) {
  }
  bInput.rewind();
  bInput.put(b,0,16);
  bOutput=ByteBuffer.allocate(8);
  c=Cipher.getInstance("DESede");
  c.init(Cipher.ENCRYPT_MODE,CIPHER_KEY_3DES);
  try {
    c.doFinal(bInput,bOutput);
    fail();
  }
 catch (  ShortBufferException expected) {
  }
}
