{
  debug(config.getLogger(),commandLine);
  Executor executor=new DefaultExecutor();
  if (wd != null) {
    executor.setWorkingDirectory(wd);
  }
  executor.setStreamHandler(new PumpStreamHandler(new DebugOutputStream(config.getLogger()),new ErrorOutputStream(config.getLogger())));
  if (env == null) {
    env=EnvironmentUtils.getProcEnvironment();
  }
  executor.setExitValue(0);
  try {
    return executor.execute(commandLine,env);
  }
 catch (  ExecuteException e) {
    ExecuteException ex=new ExecuteException("Command '" + commandLine + "' failed ",e.getExitValue());
    ex.setStackTrace(e.getStackTrace());
    throw ex;
  }
}
