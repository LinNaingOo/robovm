{
  if (buf == null) {
    throw new IllegalArgumentException(Messages.getString("security.162"));
  }
  if (offset > buf.length || len > buf.length || (len + offset) > buf.length) {
    throw new IllegalArgumentException(Messages.getString("security.163"));
  }
  if (len < DIGEST_LENGTH) {
    throw new DigestException(Messages.getString("security.164"));
  }
  if (offset < 0) {
    throw new ArrayIndexOutOfBoundsException(Messages.getString("security.165",offset));
  }
  processDigest(buf,offset);
  return DIGEST_LENGTH;
}
