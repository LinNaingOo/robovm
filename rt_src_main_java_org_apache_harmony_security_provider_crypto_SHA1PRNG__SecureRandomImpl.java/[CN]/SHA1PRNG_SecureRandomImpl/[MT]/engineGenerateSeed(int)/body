{
  byte[] myBytes;
  if (numBytes < 0) {
    throw new NegativeArraySizeException(Messages.getString("security.171",numBytes));
  }
  if (numBytes == 0) {
    return new byte[0];
  }
  if (myRandom == null) {
    myRandom=new SHA1PRNG_SecureRandomImpl();
    myRandom.engineSetSeed(RandomBitsSupplier.getRandomBits(DIGEST_LENGTH));
  }
  myBytes=new byte[numBytes];
  myRandom.engineNextBytes(myBytes);
  return myBytes;
}
