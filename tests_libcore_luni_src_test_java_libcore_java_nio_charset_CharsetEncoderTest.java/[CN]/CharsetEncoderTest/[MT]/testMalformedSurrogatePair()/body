{
  Charset cs=Charset.forName("UTF-32BE");
  CharsetEncoder e=cs.newEncoder();
  ByteBuffer bb=ByteBuffer.allocate(128);
  CoderResult cr=e.encode(CharBuffer.wrap(new char[]{'\udf9f'}),bb,false);
  assertTrue(cr.toString(),cr.isMalformed());
  assertEquals(1,cr.length());
}
