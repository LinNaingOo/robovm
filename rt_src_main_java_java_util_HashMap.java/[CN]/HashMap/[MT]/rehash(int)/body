{
  int length=calculateCapacity((capacity == 0 ? 1 : capacity << 1));
  Entry<K,V>[] newData=newElementArray(length);
  for (int i=0; i < elementData.length; i++) {
    Entry<K,V> entry=elementData[i];
    elementData[i]=null;
    while (entry != null) {
      int index=entry.origKeyHash & (length - 1);
      Entry<K,V> next=entry.next;
      entry.next=newData[index];
      newData[index]=entry;
      entry=next;
    }
  }
  elementData=newData;
  computeThreshold();
}
