{
  if (pe.name != null) {
    pe.name=PolicyUtils.expandGeneral(pe.name,new PermissionExpander().configure(ge,ks));
  }
  if (resolve) {
    if (pe.name != null) {
      pe.name=PolicyUtils.expand(pe.name,system);
    }
    if (pe.actions != null) {
      pe.actions=PolicyUtils.expand(pe.actions,system);
    }
    if (pe.signers != null) {
      pe.signers=PolicyUtils.expand(pe.signers,system);
    }
  }
  Certificate[] signers=(pe.signers == null) ? null : resolveSigners(ks,pe.signers);
  try {
    Class<?> klass=Class.forName(pe.klass);
    if (PolicyUtils.matchSubset(signers,klass.getSigners())) {
      return PolicyUtils.instantiatePermission(klass,pe.name,pe.actions);
    }
  }
 catch (  ClassNotFoundException cnfe) {
  }
  return new UnresolvedPermission(pe.klass,pe.name,pe.actions,signers);
}
