{
  for (int i=0; i < keystores.size(); i++) {
    try {
      DefaultPolicyScanner.KeystoreEntry ke=keystores.get(i);
      if (resolve) {
        ke.url=PolicyUtils.expandURL(ke.url,system);
        if (ke.type != null) {
          ke.type=PolicyUtils.expand(ke.type,system);
        }
      }
      if (ke.type == null || ke.type.length() == 0) {
        ke.type=KeyStore.getDefaultType();
      }
      KeyStore ks=KeyStore.getInstance(ke.type);
      URL location=new URL(base,ke.url);
      InputStream is=AccessController.doPrivileged(new PolicyUtils.URLLoader(location));
      try {
        ks.load(is,null);
      }
  finally {
        is.close();
      }
      return ks;
    }
 catch (    Exception e) {
    }
  }
  return null;
}
