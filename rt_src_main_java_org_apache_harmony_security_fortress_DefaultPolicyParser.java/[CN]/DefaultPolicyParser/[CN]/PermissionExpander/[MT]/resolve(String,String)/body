{
  if ("self".equals(protocol)) {
    if (ge.principals != null && ge.principals.size() != 0) {
      StringBuilder sb=new StringBuilder();
      for (Iterator<PrincipalEntry> iter=ge.principals.iterator(); iter.hasNext(); ) {
        DefaultPolicyScanner.PrincipalEntry pr=iter.next();
        if (pr.klass == null) {
          try {
            sb.append(pc2str(getPrincipalByAlias(ks,pr.name)));
          }
 catch (          Exception e) {
            throw new PolicyUtils.ExpansionFailedException(Messages.getString("security.143",pr.name),e);
          }
        }
 else {
          sb.append(pr.klass).append(" \"").append(pr.name).append("\" ");
        }
      }
      return sb.toString();
    }
 else {
      throw new PolicyUtils.ExpansionFailedException(Messages.getString("security.144"));
    }
  }
  if ("alias".equals(protocol)) {
    try {
      return pc2str(getPrincipalByAlias(ks,data));
    }
 catch (    Exception e) {
      throw new PolicyUtils.ExpansionFailedException(Messages.getString("security.143",data),e);
    }
  }
  throw new PolicyUtils.ExpansionFailedException(Messages.getString("security.145",protocol));
}
