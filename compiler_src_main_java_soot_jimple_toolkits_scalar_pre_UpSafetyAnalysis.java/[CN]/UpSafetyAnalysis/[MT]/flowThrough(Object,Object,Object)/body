{
  FlowSet in=(FlowSet)inValue, out=(FlowSet)outValue;
  in.copy(out);
  Value add=(Value)unitToGenerateMap.get(unit);
  if (add != null)   out.add(add,out);
{
    Unit u=(Unit)unit;
    Iterator outIt=(out).iterator();
    while (outIt.hasNext()) {
      EquivalentValue equiVal=(EquivalentValue)outIt.next();
      Value avail=equiVal.getValue();
      if (avail instanceof FieldRef) {
        if (sideEffect.unitCanWriteTo(u,avail))         outIt.remove();
      }
 else {
        Iterator usesIt=avail.getUseBoxes().iterator();
        while (usesIt.hasNext()) {
          Value use=((ValueBox)usesIt.next()).getValue();
          if (sideEffect.unitCanWriteTo(u,use)) {
            outIt.remove();
            break;
          }
        }
      }
    }
  }
}
