{
  if (line.trim().equals(prompt)) {
    if (!connected) {
      connected=true;
      connectionEstablished();
    }
    prompt();
    return true;
  }
  if (Log.MI.echo) {
    System.out.printf("MI<- %s\n",line);
  }
  if (Log.MI.mimicmac) {
    if (line.contains("stack-args")) {
      line=line.replace('[','{');
      line=line.replace(']','}');
    }
  }
  parser.setup(line);
  MIRecord record=parser.parse();
switch (record.type()) {
case '^':
    result(record);
  return true;
case '+':
statusAsyncOutput(record);
return true;
case '*':
execAsyncOutput(record);
return true;
case '=':
notifyAsyncOutput(record);
return true;
case '~':
consoleStreamOutput(record);
return true;
case '@':
targetStreamOutput(record);
return true;
case '&':
logStreamOutput(record);
return true;
case '?':
return true;
default :
errorBadLine(line);
return true;
}
}
