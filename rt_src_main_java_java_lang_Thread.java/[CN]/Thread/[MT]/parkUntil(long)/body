{
  if (threadPtr == 0) {
    throw new AssertionError();
  }
synchronized (lock) {
    long delayMillis=time - System.currentTimeMillis();
    if (delayMillis <= 0) {
      parkState=ParkState.UNPARKED;
    }
 else {
      parkFor(delayMillis * NANOS_PER_MILLI);
    }
  }
}
