{
  if (m_foundLast)   return DTM.NULL;
  if (DTM.NULL == m_lastFetched) {
    resetProximityPositions();
  }
  int next;
  org.apache.xpath.VariableStack vars;
  int savedStart;
  if (-1 != m_stackFrame) {
    vars=m_execContext.getVarStack();
    savedStart=vars.getStackFrame();
    vars.setStackFrame(m_stackFrame);
  }
 else {
    vars=null;
    savedStart=0;
  }
  try {
    do {
      if (0 == m_extendedTypeID) {
        next=m_lastFetched=(DTM.NULL == m_lastFetched) ? m_traverser.first(m_context) : m_traverser.next(m_context,m_lastFetched);
      }
 else {
        next=m_lastFetched=(DTM.NULL == m_lastFetched) ? m_traverser.first(m_context,m_extendedTypeID) : m_traverser.next(m_context,m_lastFetched,m_extendedTypeID);
      }
      if (DTM.NULL != next) {
        if (DTMIterator.FILTER_ACCEPT == acceptNode(next))         break;
 else         continue;
      }
 else       break;
    }
 while (next != DTM.NULL);
    if (DTM.NULL != next) {
      m_pos++;
      return next;
    }
 else {
      m_foundLast=true;
      return DTM.NULL;
    }
  }
  finally {
    if (-1 != m_stackFrame) {
      vars.setStackFrame(savedStart);
    }
  }
}
