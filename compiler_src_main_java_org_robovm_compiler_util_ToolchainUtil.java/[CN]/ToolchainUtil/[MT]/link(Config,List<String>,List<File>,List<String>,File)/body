{
  File objectsFile=new File(config.getTmpDir(),"objects");
  BufferedOutputStream objectsOut=null;
  try {
    objectsOut=new BufferedOutputStream(new FileOutputStream(objectsFile));
    for (    File f : objectFiles) {
      objectsOut.write('"');
      objectsOut.write(f.getAbsolutePath().getBytes());
      objectsOut.write('"');
      objectsOut.write('\n');
    }
  }
  finally {
    IOUtils.closeQuietly(objectsOut);
  }
  List<String> opts=new ArrayList<String>();
  if (config.isDebug()) {
    opts.add("-g");
  }
  if (config.getOs().getFamily() == OS.Family.darwin) {
    opts.add("-arch");
    opts.add(config.getArch().getClangName());
    opts.add("-Wl,-filelist," + objectsFile.getAbsolutePath());
  }
 else {
    opts.add("-m32");
    opts.add("@" + objectsFile.getAbsolutePath());
  }
  opts.addAll(args);
  new Executor(config.getLogger(),getCcPath(config)).args("-o",outFile,opts,libs).exec();
}
