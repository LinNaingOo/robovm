{
synchronized (connectionPool) {
    List<HttpConnection> connections=connectionPool.get(address);
    while (connections != null) {
      HttpConnection connection=connections.remove(connections.size() - 1);
      if (connections.isEmpty()) {
        connectionPool.remove(address);
        connections=null;
      }
      if (connection.isEligibleForRecycling()) {
        Socket socket=connection.getSocket();
        SocketTagger.get().tag(socket);
        return connection;
      }
    }
  }
  return address.connect(connectTimeout);
}
