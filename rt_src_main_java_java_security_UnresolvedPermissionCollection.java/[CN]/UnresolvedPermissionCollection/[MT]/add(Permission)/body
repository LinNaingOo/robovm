{
  if (isReadOnly()) {
    throw new SecurityException(Messages.getString("security.15"));
  }
  if (permission == null || permission.getClass() != UnresolvedPermission.class) {
    throw new IllegalArgumentException(Messages.getString("security.16",permission));
  }
synchronized (klasses) {
    String klass=permission.getName();
    Collection klassMates=(Collection)klasses.get(klass);
    if (klassMates == null) {
      klassMates=new HashSet();
      klasses.put(klass,klassMates);
    }
    klassMates.add(permission);
  }
}
