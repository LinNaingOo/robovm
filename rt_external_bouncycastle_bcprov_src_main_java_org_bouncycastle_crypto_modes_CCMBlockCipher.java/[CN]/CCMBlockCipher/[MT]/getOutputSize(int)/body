{
  int totalData=len + data.size();
  if (forEncryption) {
    return totalData + macSize;
  }
  return totalData < macSize ? 0 : totalData - macSize;
}
