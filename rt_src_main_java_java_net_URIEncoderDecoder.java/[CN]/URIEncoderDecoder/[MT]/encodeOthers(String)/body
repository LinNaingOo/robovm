{
  StringBuilder buf=new StringBuilder();
  for (int i=0; i < s.length(); i++) {
    char ch=s.charAt(i);
    if (ch <= 127) {
      buf.append(ch);
    }
 else {
      byte[] bytes=new String(new char[]{ch}).getBytes(encoding);
      for (int j=0; j < bytes.length; j++) {
        buf.append('%');
        buf.append(digits.charAt((bytes[j] & 0xf0) >> 4));
        buf.append(digits.charAt(bytes[j] & 0xf));
      }
    }
  }
  return buf.toString();
}
