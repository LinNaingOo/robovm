{
  Arrays.checkOffsetAndCount(buffer.length,offset,count);
synchronized (lock) {
    checkNotClosed();
    if (pos < this.count) {
      int bytesRead=pos + count > this.count ? this.count - pos : count;
      System.arraycopy(this.buf,pos,buffer,offset,bytesRead);
      pos+=bytesRead;
      return bytesRead;
    }
    return -1;
  }
}
