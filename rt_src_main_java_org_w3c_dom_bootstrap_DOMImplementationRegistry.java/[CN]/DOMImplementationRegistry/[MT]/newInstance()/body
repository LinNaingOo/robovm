{
  Vector sources=new Vector();
  ClassLoader classLoader=getClassLoader();
  String p=getSystemProperty(PROPERTY);
  if (p == null || p.length() == 0) {
    p=getServiceValue(classLoader);
  }
  if (p == null) {
    p=DEFAULT_DOM_IMPLEMENTATION_SOURCE;
  }
  if (p != null) {
    StringTokenizer st=new StringTokenizer(p);
    while (st.hasMoreTokens()) {
      String sourceName=st.nextToken();
      Class sourceClass=null;
      if (classLoader != null) {
        sourceClass=classLoader.loadClass(sourceName);
      }
 else {
        sourceClass=Class.forName(sourceName);
      }
      DOMImplementationSource source=(DOMImplementationSource)sourceClass.newInstance();
      sources.addElement(source);
    }
  }
  return new DOMImplementationRegistry(sources);
}
