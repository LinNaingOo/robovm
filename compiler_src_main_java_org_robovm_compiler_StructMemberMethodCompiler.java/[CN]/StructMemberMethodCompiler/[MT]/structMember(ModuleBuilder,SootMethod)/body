{
  SootClass sootClass=method.getDeclaringClass();
  StructureType structType=getStructType(sootClass);
  if (structType == null) {
    throw new IllegalArgumentException("Struct class " + sootClass + " has no @StructMember annotated methods");
  }
  Function function=FunctionBuilder.structMember(method);
  moduleBuilder.addFunction(function);
  Variable handleI64=function.newVariable(I64);
  function.add(new Load(handleI64,getFieldPtr(function,function.getParameterRef(1),offsetof(new StructureType(DATA_OBJECT,new StructureType(I64)),1,0),I64)));
  Variable handlePtr=function.newVariable(new PointerType(structType));
  function.add(new Inttoptr(handlePtr,handleI64.ref(),handlePtr.getType()));
  int offset=getStructMemberOffset(method);
  Type memberType=structType.getTypeAt(offset);
  Variable memberPtr=function.newVariable(new PointerType(memberType));
  function.add(new Getelementptr(memberPtr,handlePtr.ref(),0,offset));
  StructMemberPair pair=getStructMemberPair(sootClass,offset);
  VariableRef env=function.getParameterRef(0);
  if (method == pair.getGetter()) {
    soot.Type type=method.getReturnType();
    Value result=null;
    if (memberType instanceof StructureType) {
      result=memberPtr.ref();
    }
 else {
      Variable tmp=function.newVariable(memberType);
      function.add(new Load(tmp,memberPtr.ref()));
      result=tmp.ref();
    }
    if (needsMarshaler(type)) {
      String marshalerClassName=getMarshalerClassName(method,true);
      String targetClassName=getInternalName(type);
      if (memberType instanceof PrimitiveType) {
        if (isEnum(type)) {
          result=marshalNativeToEnumObject(function,marshalerClassName,env,targetClassName,result);
        }
 else {
          result=marshalNativeToValueObject(function,marshalerClassName,env,targetClassName,result);
        }
      }
 else {
        if (isPtr(type)) {
          result=marshalNativeToPtr(function,marshalerClassName,null,env,getPtrTargetClass(method),result,getPtrWrapCount(method));
        }
 else {
          result=marshalNativeToObject(function,marshalerClassName,null,env,targetClassName,result,false);
        }
      }
    }
 else     if (hasPointerAnnotation(method)) {
      result=marshalPointerToLong(function,result);
    }
    function.add(new Ret(result));
  }
 else {
    Value nativeValue=function.getParameterRef(2);
    soot.Type type=method.getParameterType(0);
    if (needsMarshaler(type)) {
      String marshalerClassName=getMarshalerClassName(method,0,false);
      if (memberType instanceof PrimitiveType) {
        if (isEnum(type)) {
          nativeValue=marshalEnumObjectToNative(function,marshalerClassName,memberType,env,nativeValue);
        }
 else {
          nativeValue=marshalValueObjectToNative(function,marshalerClassName,memberType,env,nativeValue);
        }
      }
 else {
        if (memberType instanceof StructureType) {
          call(function,CHECK_NULL,env,nativeValue);
        }
        nativeValue=marshalObjectToNative(function,marshalerClassName,null,memberType,env,nativeValue);
      }
    }
 else     if (hasPointerAnnotation(method,0)) {
      nativeValue=marshalLongToPointer(function,nativeValue);
    }
    function.add(new Store(nativeValue,memberPtr.ref()));
    if (method.getReturnType().equals(VoidType.v())) {
      function.add(new Ret());
    }
 else {
      function.add(new Ret(function.getParameterRef(1)));
    }
  }
}
