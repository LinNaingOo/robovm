{
  whm=new WeakHashMap();
  for (int i=0; i < 100; i++)   whm.put(keyArray[i],valueArray[i]);
  List keys=Arrays.asList(keyArray);
  List values=Arrays.asList(valueArray);
  Collection valuesCollection=whm.values();
  assertEquals("Incorrect number of keys returned,",100,valuesCollection.size());
  Iterator it=valuesCollection.iterator();
  while (it.hasNext()) {
    Object value=it.next();
    assertTrue("Invalid map entry returned--bad value",values.contains(value));
  }
  keys=null;
  values=null;
  keyArray[50]=null;
  int count=0;
  do {
    System.gc();
    System.gc();
    Runtime.getRuntime().runFinalization();
    count++;
  }
 while (count <= 5 && valuesCollection.size() == 100);
  assertEquals("Incorrect number of keys returned after gc,",99,valuesCollection.size());
}
