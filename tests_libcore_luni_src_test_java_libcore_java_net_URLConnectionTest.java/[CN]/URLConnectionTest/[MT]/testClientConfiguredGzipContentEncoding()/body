{
  server.enqueue(new MockResponse().setBody(gzip("ABCDEFGHIJKLMNOPQRSTUVWXYZ".getBytes("UTF-8"))).addHeader("Content-Encoding: gzip"));
  server.play();
  URLConnection connection=server.getUrl("/").openConnection();
  connection.addRequestProperty("Accept-Encoding","gzip");
  InputStream gunzippedIn=new GZIPInputStream(connection.getInputStream());
  assertEquals("ABCDEFGHIJKLMNOPQRSTUVWXYZ",readAscii(gunzippedIn,Integer.MAX_VALUE));
  RecordedRequest request=server.takeRequest();
  assertContains(request.getHeaders(),"Accept-Encoding: gzip");
}
