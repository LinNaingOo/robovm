{
  TestSSLContext testSSLContext=TestSSLContext.create();
  server.useHttps(testSSLContext.serverContext.getSocketFactory(),false);
  server.enqueue(new MockResponse());
  server.play();
  HttpsURLConnection connection=(HttpsURLConnection)server.getUrl("/").openConnection();
  connection.setSSLSocketFactory(testSSLContext.clientContext.getSocketFactory());
  connection.connect();
  assertNotNull(connection.getHostnameVerifier());
  assertNull(connection.getLocalCertificates());
  assertNotNull(connection.getServerCertificates());
  assertNotNull(connection.getCipherSuite());
  assertNotNull(connection.getPeerPrincipal());
}
