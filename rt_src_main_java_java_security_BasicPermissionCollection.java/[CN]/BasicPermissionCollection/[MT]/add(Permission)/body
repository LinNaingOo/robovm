{
  if (isReadOnly()) {
    throw new SecurityException(Messages.getString("security.15"));
  }
  if (permission == null) {
    throw new IllegalArgumentException(Messages.getString("security.20"));
  }
  Class<? extends Permission> inClass=permission.getClass();
  if (permClass != null) {
    if (permClass != inClass) {
      throw new IllegalArgumentException(Messages.getString("security.16",permission));
    }
  }
 else   if (!(permission instanceof BasicPermission)) {
    throw new IllegalArgumentException(Messages.getString("security.16",permission));
  }
 else {
synchronized (this) {
      if (permClass != null && inClass != permClass) {
        throw new IllegalArgumentException(Messages.getString("security.16",permission));
      }
      permClass=inClass;
    }
  }
  String name=permission.getName();
  items.put(name,permission);
  allEnabled=allEnabled || (name.length() == 1 && '*' == name.charAt(0));
}
