{
  StringBuilder fullForm=new StringBuilder(39);
  final int NUM_OF_IPV6_FIELDS=8;
  String[] fields=compressed.split(":");
  int numOfCompressedFields;
  if (compressed.startsWith("::")) {
    compressed=compressed.replace("::","");
    fields=compressed.split(":");
    numOfCompressedFields=NUM_OF_IPV6_FIELDS - fields.length;
    restoreCompressedFieldsWithZero(fullForm,numOfCompressedFields);
    appendNonZeroFields(fullForm,fields);
  }
 else   if (compressed.endsWith("::")) {
    compressed=compressed.replace("::","");
    fields=compressed.split(":");
    numOfCompressedFields=NUM_OF_IPV6_FIELDS - fields.length;
    appendNonZeroFields(fullForm,fields);
    restoreCompressedFieldsWithZero(fullForm,numOfCompressedFields);
  }
 else {
    numOfCompressedFields=NUM_OF_IPV6_FIELDS - fields.length + 1;
    for (    String field : fields) {
      if (field.equals("")) {
        restoreCompressedFieldsWithZero(fullForm,numOfCompressedFields);
      }
 else {
        fullForm.append(field);
        fullForm.append(":");
      }
    }
  }
  fullForm.deleteCharAt(fullForm.length() - 1);
  return fullForm.toString();
}
