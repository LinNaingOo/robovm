{
  Proxy proxy=new Proxy(Proxy.Type.SOCKS,new InetSocketAddress("127.0.0.1",0));
  Socket socket=new Socket(proxy);
  try {
    InetAddress address=InetAddress.getByName("localhost");
    int port=0;
    socket.bind(new InetSocketAddress(address,port));
    assertEquals(address,socket.getLocalAddress());
    assertTrue(port != socket.getLocalPort());
  }
  finally {
    socket.close();
  }
}
