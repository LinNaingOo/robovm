{
  String prefix="";
  if ((startSubstring >= 0) && (posOfNSSep >= 0)) {
    prefix=pat.substring(startSubstring,posOfNSSep);
  }
  String uName;
  if ((null != m_namespaceContext) && !prefix.equals("*") && !prefix.equals("xmlns")) {
    try {
      if (prefix.length() > 0)       uName=((PrefixResolver)m_namespaceContext).getNamespaceForPrefix(prefix);
 else {
        if (false) {
          addToTokenQueue(":");
          String s=pat.substring(posOfNSSep + 1,posOfScan);
          if (s.length() > 0)           addToTokenQueue(s);
          return -1;
        }
 else {
          uName=((PrefixResolver)m_namespaceContext).getNamespaceForPrefix(prefix);
        }
      }
    }
 catch (    ClassCastException cce) {
      uName=m_namespaceContext.getNamespaceForPrefix(prefix);
    }
  }
 else {
    uName=prefix;
  }
  if ((null != uName) && (uName.length() > 0)) {
    addToTokenQueue(uName);
    addToTokenQueue(":");
    String s=pat.substring(posOfNSSep + 1,posOfScan);
    if (s.length() > 0)     addToTokenQueue(s);
  }
 else {
    m_processor.errorForDOM3(XPATHErrorResources.ER_PREFIX_MUST_RESOLVE,new String[]{prefix});
  }
  return -1;
}
