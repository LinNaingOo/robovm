{
  JarFile jar=null;
  if (jarFileURL.getProtocol().equals("file")) {
    jar=new JarFile(new File(Util.decode(jarFileURL.getFile(),false,"UTF-8")),true,ZipFile.OPEN_READ);
  }
 else {
    final InputStream is=jarFileURL.openConnection().getInputStream();
    try {
      jar=AccessController.doPrivileged(new PrivilegedAction<JarFile>(){
        public JarFile run(){
          FileOutputStream fos=null;
          try {
            File tempJar=File.createTempFile("hyjar_",".tmp",null);
            tempJar.deleteOnExit();
            fos=new FileOutputStream(tempJar);
            byte[] buf=new byte[4096];
            int nbytes=0;
            while ((nbytes=is.read(buf)) > -1) {
              fos.write(buf,0,nbytes);
            }
            fos.close();
            return new JarFile(tempJar,true,ZipFile.OPEN_READ | ZipFile.OPEN_DELETE);
          }
 catch (          IOException e) {
            return null;
          }
 finally {
            if (fos != null) {
              try {
                fos.close();
              }
 catch (              IOException e) {
              }
            }
          }
        }
      }
);
    }
  finally {
      if (is != null) {
        is.close();
      }
    }
  }
  return jar;
}
