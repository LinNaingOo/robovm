{
  long utfCount=countUTFBytes(str);
  if (utfCount > 65535) {
    throw new UTFDataFormatException(Messages.getString("luni.AB"));
  }
  byte[] buffer=new byte[(int)utfCount + 2];
  int offset=0;
  offset=writeShortToBuffer((int)utfCount,buffer,offset);
  offset=writeUTFBytesToBuffer(str,(int)utfCount,buffer,offset);
  write(buffer,0,offset);
}
