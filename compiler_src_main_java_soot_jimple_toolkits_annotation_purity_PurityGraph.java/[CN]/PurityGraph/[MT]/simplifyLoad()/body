{
  Iterator it=(new LinkedList(nodes)).iterator();
  while (it.hasNext()) {
    PurityNode p=(PurityNode)it.next();
    Map<String,PurityNode> fmap=new HashMap<String,PurityNode>();
    Iterator itt=(new LinkedList(edges.get(p))).iterator();
    while (itt.hasNext()) {
      PurityEdge e=(PurityEdge)itt.next();
      PurityNode tgt=e.getTarget();
      if (!e.isInside() && !tgt.equals(p)) {
        String f=e.getField();
        if (fmap.containsKey(f) && nodes.contains(fmap.get(f)))         mergeNodes(tgt,fmap.get(f));
 else         fmap.put(f,tgt);
      }
    }
  }
  if (doCheck)   sanityCheck();
}
