{
  if (opmode != ENCRYPT_MODE && opmode != DECRYPT_MODE && opmode != UNWRAP_MODE && opmode != WRAP_MODE) {
    throw new InvalidParameterException(Messages.getString("crypto.19"));
  }
  spiImpl.engineInit(opmode,key,random);
  mode=opmode;
}
